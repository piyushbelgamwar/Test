import com.launchdarkly.sdk.*;
import com.launchdarkly.sdk.server.*;

import java.time.Instant;
import java.time.ZoneId;
import java.time.ZonedDateTime;

public class LDFlagManager {

    private static final String LD_SDK_KEY = "YOUR_SDK_KEY";
    private static final String USER_KEY = "user-123"; // Can be dynamic or user ID

    private static final String FEATURE_FLAG_KEY = "your-flag-key";

    public static void main(String[] args) {
        boolean result = checkFlagStatusBasedOnTime();
        System.out.println("Should serve flag: " + result);
    }

    public static boolean checkFlagStatusBasedOnTime() {
        try (LDClient ldClient = new LDClient(LD_SDK_KEY)) {

            // Scheduled time: June 20, 2025, 5:51 AM BST â†’ convert to UTC
            ZonedDateTime scheduledBST = ZonedDateTime.of(
                    2025, 6, 20, 5, 51, 0, 0,
                    ZoneId.of("Europe/London")
            );
            Instant scheduledTimeUTC = scheduledBST.toInstant();

            Instant now = Instant.now();

            boolean isAfterTime = now.isAfter(scheduledTimeUTC);

            // Build context with custom attribute
            LDContext context = LDContext.builder(USER_KEY)
                    .set("isAfterTime", isAfterTime)
                    .build();

            // Flag evaluation
            return ldClient.boolVariation(FEATURE_FLAG_KEY, context, false);
        }
    }
}